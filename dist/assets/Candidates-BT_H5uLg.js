import{c as g,r as c,a as A,u as I,j as e,R as E,e as F}from"./index-COlkUDDC.js";import{O as C,h as i}from"./OperatorsHeader-DO4M1TH_.js";import{B as k}from"./LoadingSpinner-Dv9zkxqr.js";import{a as U,b as K}from"./Skeleton-BUx6TIRe.js";import{C as L}from"./ConfirmModal-BlwSzeah.js";import{b as P}from"./EmptyState-D13k4Kaw.js";/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=g("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=g("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=g("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);function Q(){const[f,y]=c.useState([]),[S,u]=c.useState(!0),[x,h]=c.useState(!1),[a,r]=c.useState("all"),[p,b]=c.useState({isOpen:!1}),o=A(),{email:n,userRoles:j}=I(),v=t=>{window.history.pushState({},"",t),window.dispatchEvent(new PopStateEvent("popstate")),window.scrollTo({top:0,behavior:"instant"})};c.useEffect(()=>{(async()=>{if(!n){u(!1);return}try{u(!0);const s=a==="all"?`/api/operators/candidates?email=${encodeURIComponent(n)}`:`/api/operators/candidates?email=${encodeURIComponent(n)}&status=${a}`,l=await(await fetch(s)).json();l.ok&&y(l.candidates||[])}catch(s){console.error("Failed to fetch candidates:",s)}finally{u(!1)}})()},[n,a]);const w=async t=>{h(!0);try{const d=await(await fetch(`/api/operators/candidates/${t}/approve`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n})})).json();if(d.ok){const l=a==="all"?`/api/operators/candidates?email=${encodeURIComponent(n)}`:`/api/operators/candidates?email=${encodeURIComponent(n)}&status=${a}`,m=await(await fetch(l)).json();m.ok&&(y(m.candidates||[]),o.success("Candidate approved successfully"))}else o.error(d.error||"Failed to approve candidate")}catch{o.error("Failed to approve candidate. Please try again.")}finally{h(!1)}},N=async t=>{b({isOpen:!0,title:"Deny Candidate",message:"Are you sure you want to deny this candidate?",onConfirm:()=>$(t),variant:"danger"})},$=async t=>{h(!0);try{const d=await(await fetch(`/api/operators/candidates/${t}/deny`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n})})).json();if(d.ok){const l=a==="all"?`/api/operators/candidates?email=${encodeURIComponent(n)}`:`/api/operators/candidates?email=${encodeURIComponent(n)}&status=${a}`,m=await(await fetch(l)).json();m.ok&&(y(m.candidates||[]),o.success("Candidate denied"))}else o.error(d.error||"Failed to deny candidate")}catch{o.error("Failed to deny candidate. Please try again.")}finally{h(!1)}},D=t=>{switch(t){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"denied":return"bg-red-100 text-red-800";case"promoted":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},_=t=>{switch(t){case"pending":return e.jsx(J,{className:"w-4 h-4"});case"approved":return e.jsx(F,{className:"w-4 h-4"});case"denied":return e.jsx(T,{className:"w-4 h-4"});case"promoted":return e.jsx(M,{className:"w-4 h-4"});default:return null}},R=j.includes("chief_operator")||j.includes("super_admin");return S?e.jsxs("div",{className:"min-h-screen bg-[#fafafa]",children:[e.jsx(C,{active:"candidates",onNavigate:v}),e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl","aria-busy":"true","aria-label":"Loading candidates",children:[e.jsx(U,{className:"h-8 mb-6",width:"40%"}),e.jsx(K,{rows:6,cols:4})]})]}):e.jsxs("div",{className:"min-h-screen bg-[#fafafa]",children:[e.jsx(C,{active:"candidates",onNavigate:v}),e.jsx(L,{isOpen:p.isOpen,onClose:()=>b({isOpen:!1}),onConfirm:p.onConfirm,title:p.title,message:p.message,variant:p.variant||"default"}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-7xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:"Candidates"}),e.jsxs("div",{className:"flex gap-2",role:"group","aria-label":"Filter candidates by status",children:[e.jsx("button",{onClick:()=>r("all"),onKeyDown:i(()=>r("all")),className:`min-h-[44px] px-4 py-2 rounded-lg text-sm flex items-center justify-center ${a==="all"?"bg-blue-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,"aria-label":"Show all candidates","aria-pressed":a==="all",children:"All"}),e.jsx("button",{onClick:()=>r("pending"),onKeyDown:i(()=>r("pending")),className:`min-h-[44px] px-4 py-2 rounded-lg text-sm flex items-center justify-center ${a==="pending"?"bg-blue-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,"aria-label":"Show pending candidates","aria-pressed":a==="pending",children:"Pending"}),e.jsx("button",{onClick:()=>r("approved"),onKeyDown:i(()=>r("approved")),className:`min-h-[44px] px-4 py-2 rounded-lg text-sm flex items-center justify-center ${a==="approved"?"bg-blue-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,"aria-label":"Show approved candidates","aria-pressed":a==="approved",children:"Approved"}),e.jsx("button",{onClick:()=>r("denied"),onKeyDown:i(()=>r("denied")),className:`min-h-[44px] px-4 py-2 rounded-lg text-sm flex items-center justify-center ${a==="denied"?"bg-blue-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,"aria-label":"Show denied candidates","aria-pressed":a==="denied",children:"Denied"}),e.jsx("button",{onClick:()=>r("promoted"),onKeyDown:i(()=>r("promoted")),className:`min-h-[44px] px-4 py-2 rounded-lg text-sm flex items-center justify-center ${a==="promoted"?"bg-blue-600 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,"aria-label":"Show promoted candidates","aria-pressed":a==="promoted",children:"Promoted"})]})]}),f.length===0?e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:e.jsx(P,{})}):e.jsx("div",{className:"space-y-4",children:f.map(t=>{const s=t.operators_events;return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.candidate_email}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium flex items-center gap-1 ${D(t.status)}`,"aria-label":`Candidate status: ${t.status}`,children:[E.cloneElement(_(t.status),{"aria-hidden":"true"}),t.status]})]}),s&&e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsx("span",{className:"font-medium",children:"Event:"})," ",s.title," (",new Date(s.event_date).toLocaleDateString(),")"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Invited by:"})," ",t.invited_by_email]}),t.approved_by_email&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Approved by:"})," ",t.approved_by_email]}),t.approved_at&&e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Approved:"})," ",new Date(t.approved_at).toLocaleDateString()]})]}),R&&t.status==="pending"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>w(t.id),onKeyDown:i(()=>w(t.id)),disabled:x,className:"min-h-[44px] px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 text-sm flex items-center justify-center","aria-label":`Approve candidate ${t.candidate_email}`,children:x?e.jsxs(e.Fragment,{children:[e.jsx(k,{})," Approving..."]}):"Approve"}),e.jsx("button",{onClick:()=>N(t.id),onKeyDown:i(()=>N(t.id)),disabled:x,className:"min-h-[44px] px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 text-sm flex items-center justify-center","aria-label":`Deny candidate ${t.candidate_email}`,children:x?e.jsxs(e.Fragment,{children:[e.jsx(k,{})," Denying..."]}):"Deny"})]})]}),e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"Essay:"}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:t.essay})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Contact Info:"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.contact_info})]})]},t.id)})})]})]})}export{Q as default};
//# sourceMappingURL=Candidates-BT_H5uLg.js.map
