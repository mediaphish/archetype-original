import{c as C,r as n,a as $,u as T,j as e,S as A}from"./index--duSovw8.js";import{O as u,h as N}from"./OperatorsHeader-7q8Nrr1Q.js";import{C as E}from"./ConfirmModal-GzpNVcLa.js";/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=C("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.452.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=C("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function J(){const[y,d]=n.useState([]),[O,p]=n.useState(!0),[g,c]=n.useState(!1),[m,b]=n.useState(""),[x,j]=n.useState(""),[l,f]=n.useState({isOpen:!1}),t=$(),{email:o,userRoles:R}=T(),h=s=>{window.history.pushState({},"",s),window.dispatchEvent(new PopStateEvent("popstate")),window.scrollTo({top:0,behavior:"instant"})};n.useEffect(()=>{(async()=>{if(!o){p(!1);return}try{p(!0);const a=await(await fetch(`/api/operators/users?email=${encodeURIComponent(o)}`)).json();a.ok?d(a.users||[]):a.error&&a.error.includes("Super Admin")&&d([])}catch(r){console.error("Failed to fetch users:",r)}finally{p(!1)}})()},[o]);const v=async s=>{if(!s){t.error("Please enter an email address");return}f({isOpen:!0,title:"Promote to Chief Operator",message:`Promote ${s} to Chief Operator?`,onConfirm:()=>S(s),variant:"default"})},S=async s=>{c(!0);try{const a=await(await fetch(`/api/operators/users/${encodeURIComponent(s)}/promote`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o})})).json();if(a.ok){b("");const i=await(await fetch(`/api/operators/users?email=${encodeURIComponent(o)}`)).json();i.ok&&d(i.users||[]),t.success("User promoted successfully")}else t.error(a.error||"Failed to promote user")}catch{t.error("Failed to promote user. Please try again.")}finally{c(!1)}},w=async s=>{if(!s){t.error("Please enter an email address");return}f({isOpen:!0,title:"Reverse Offenses",message:`Reverse all offenses for ${s}? This will remove card status, bench status, and owed balance.`,onConfirm:()=>P(s),variant:"danger"})},P=async s=>{c(!0);try{const a=await(await fetch(`/api/operators/users/${encodeURIComponent(s)}/reverse-offense`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o})})).json();if(a.ok){j("");const i=await(await fetch(`/api/operators/users?email=${encodeURIComponent(o)}`)).json();i.ok&&d(i.users||[]),t.success("Offenses reversed successfully")}else t.error(a.error||"Failed to reverse offenses")}catch{t.error("Failed to reverse offenses. Please try again.")}finally{c(!1)}},k=s=>{switch(s){case"yellow":return"bg-yellow-100 text-yellow-800";case"orange":return"bg-orange-100 text-orange-800";case"red":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},U=R.includes("super_admin");return O?e.jsxs("div",{className:"min-h-screen bg-[#fafafa]",children:[e.jsx(u,{active:"admin",onNavigate:h}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:"Loading..."})]}):U?e.jsxs("div",{className:"min-h-screen bg-[#fafafa]",children:[e.jsx(u,{active:"admin",onNavigate:h}),e.jsx(E,{isOpen:l.isOpen,onClose:()=>f({isOpen:!1}),onConfirm:l.onConfirm,title:l.title,message:l.message,variant:l.variant||"default"}),e.jsxs("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900 mb-6",children:"Admin Controls"}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5","aria-hidden":"true"}),"Promote to Chief Operator"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"email",value:m,onChange:s=>b(s.target.value),placeholder:"user@example.com",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg","aria-label":"Email address of user to promote"}),e.jsx("button",{onClick:()=>v(m),onKeyDown:N(()=>v(m)),disabled:g||!m,className:"min-h-[44px] px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center justify-center","aria-label":"Promote user to Chief Operator",children:"Promote"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(L,{className:"w-5 h-5","aria-hidden":"true"}),"Reverse Offense"]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"This will remove card status, bench status, and reset owed balance for a user."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"email",value:x,onChange:s=>j(s.target.value),placeholder:"user@example.com",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg","aria-label":"Email address of user to reverse offenses for"}),e.jsx("button",{onClick:()=>w(x),onKeyDown:N(()=>w(x)),disabled:g||!x,className:"min-h-[44px] px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 flex items-center justify-center","aria-label":"Reverse all offenses for user",children:"Reverse"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5","aria-hidden":"true"}),"All Users"]}),y.length===0?e.jsx("p",{className:"text-gray-600",children:"No users found."}):e.jsx("div",{className:"space-y-3",children:y.map(s=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900 mb-2",children:s.email}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:s.roles&&s.roles.length>0?s.roles.map(r=>e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:r},r)):e.jsx("span",{className:"text-xs text-gray-500",children:"No roles"})}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[s.card_status!=="none"&&e.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${k(s.card_status)}`,children:["Card: ",s.card_status," (",s.card_count||0,")"]}),s.benched_until&&e.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-800 rounded text-xs",children:["Benched until: ",new Date(s.benched_until).toLocaleDateString()]}),s.owed_balance>0&&e.jsxs("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-xs",children:["Owed: $",s.owed_balance]})]})]})})},s.id))})]})]})]}):e.jsxs("div",{className:"min-h-screen bg-[#fafafa]",children:[e.jsx(u,{active:"admin",onNavigate:h}),e.jsx("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:e.jsx("div",{className:"bg-white rounded-xl border border-red-200 p-6 shadow-sm",children:e.jsx("p",{className:"text-red-600",children:"Only Super Admins can access this page."})})})]})}export{J as default};
//# sourceMappingURL=Admin-D7H85I-C.js.map
