import{r as s,u as b,j as t}from"./index-BL-EUMyF.js";import{O as f,h as i}from"./OperatorsHeader-CB51NOzU.js";import{S as w}from"./Skeleton-C9qk8hpt.js";import{E as y}from"./EmptyState-BRVxrir5.js";function $(){const[c,p]=s.useState([]),[g,n]=s.useState(!0),[r,d]=s.useState("all"),{email:l,userRoles:m,isAuthenticated:u}=b();s.useEffect(()=>{!u&&!l&&window.location.replace("/operators/login")},[u,l]);const a=s.useCallback(e=>{window.history.pushState({},"",e),window.dispatchEvent(new PopStateEvent("popstate")),window.scrollTo({top:0,behavior:"instant"})},[]);s.useEffect(()=>{(async()=>{if(!l){n(!1);return}try{n(!0);const o=r!=="all"?`&state=${r}`:"",x=await(await fetch(`/api/operators/events?email=${encodeURIComponent(l)}${o}`)).json();x.ok&&p(x.events||[])}catch(o){console.error("Failed to fetch events:",o)}finally{n(!1)}})()},[l,r]);const h=s.useCallback(e=>{switch(e){case"LIVE":return"bg-blue-100 text-blue-800";case"OPEN":return"bg-green-100 text-green-800";case"CLOSED":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},[]);return t.jsxs("div",{className:"min-h-screen bg-[#fafafa]",children:[t.jsx(f,{active:"events",onNavigate:a}),t.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-7xl",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:"Events"}),(m.includes("chief_operator")||m.includes("super_admin"))&&t.jsx("button",{onClick:()=>a("/operators/events/new"),onKeyDown:i(()=>a("/operators/events/new")),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700","aria-label":"Create a new event",children:"Create Event"})]}),t.jsx("div",{className:"flex gap-2 mb-6",role:"group","aria-label":"Filter events by state",children:["all","LIVE","OPEN","CLOSED"].map(e=>t.jsx("button",{onClick:()=>d(e),onKeyDown:i(()=>d(e)),className:`px-4 py-2 rounded-lg ${r===e?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,"aria-label":`Filter events by ${e==="all"?"all states":e.toLowerCase()} state`,"aria-pressed":r===e,children:e==="all"?"All Events":e},e))}),g?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6","aria-busy":"true","aria-label":"Loading events",children:[1,2,3,4,5,6].map(e=>t.jsx(w,{},e))}):c.length===0?t.jsx(y,{onCreateEvent:()=>a("/operators/events/new")}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",role:"list","aria-label":"Events list",children:c.map(e=>t.jsxs("div",{onClick:()=>a(`/operators/events/${e.id}`),onKeyDown:i(()=>a(`/operators/events/${e.id}`)),className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md cursor-pointer transition-shadow",role:"listitem",tabIndex:0,"aria-label":`Event: ${e.title}, ${new Date(e.event_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}, ${e.confirmed_count} of ${e.max_seats} seats filled`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${h(e.state)}`,"aria-label":`Event state: ${e.state}`,children:e.state}),e.user_rsvp_status&&t.jsxs("span",{className:"text-sm text-gray-500","aria-label":`Your RSVP status: ${e.user_rsvp_status}`,children:["RSVP: ",e.user_rsvp_status]})]}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e.title}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:new Date(e.event_date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}),t.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[t.jsxs("span",{"aria-label":`${e.confirmed_count} confirmed out of ${e.max_seats} total seats`,children:[e.confirmed_count,"/",e.max_seats," seats"]}),e.waitlist_count>0&&t.jsxs("span",{"aria-label":`${e.waitlist_count} people on waitlist`,children:[e.waitlist_count," waitlisted"]})]})]},e.id))})]})]})}export{$ as default};
//# sourceMappingURL=Events-Frtnu3g3.js.map
