import{u as D,r as d,j as e,O as v}from"./index-DKam6_qV.js";import{O as N}from"./OperatorsHeader-xTktS3a8.js";import{B as L}from"./LoadingSpinner-sbML65Ra.js";import{p as O,f as T,a as $}from"./input-masks-C2mlJJff.js";function U(){const{email:w,userRoles:h}=D(),[s,p]=d.useState({title:"",event_date:"",start_time:"",finish_time:"",stake_amount:"",max_seats:"",host_name:"",host_logo_url:"",host_location:"",host_location_lat:"",host_location_lng:"",host_description:"",sponsor_name:"",sponsor_logo_url:"",sponsor_website:"",sponsor_phone:"",sponsor_pot_value:"",sponsor_description:""}),[b,c]=d.useState(!1),[u,f]=d.useState({host:!1,sponsor:!1}),[_,n]=d.useState(""),[C,y]=d.useState(!1),[x,k]=d.useState(0),[g,S]=d.useState(0),m=r=>{window.history.pushState({},"",r),window.dispatchEvent(new PopStateEvent("popstate")),window.scrollTo({top:0,behavior:"instant"})},j=async(r,t)=>{if(t){if(!["image/png","image/jpeg","image/jpg"].includes(t.type.toLowerCase())){n("Logo must be PNG or JPG format");return}if(t.size>2*1024*1024){n("Logo file size must be less than 2MB");return}f(o=>({...o,[r]:!0})),n("");try{const o=new FormData;o.append("logoType",r),o.append("file",t);const i=await(await fetch("/api/operators/upload-logo",{method:"POST",body:o})).json();i.ok?p(P=>({...P,[`${r}_logo_url`]:i.logoUrl})):n(i.error||"Failed to upload logo")}catch(o){n("Failed to upload logo. Please try again."),console.error("Logo upload error:",o)}finally{f(o=>({...o,[r]:!1}))}}},F=()=>s.host_location?`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(s.host_location)}`:"",E=async r=>{if(r.preventDefault(),c(!0),n(""),y(!1),s.host_description&&s.host_description.trim().split(/\s+/).length>150){n("Host description must be 150 words or less"),c(!1);return}if(s.sponsor_description&&s.sponsor_description.trim().split(/\s+/).length>150){n("Sponsor description must be 150 words or less"),c(!1);return}if(!s.title||!s.event_date||!s.start_time||!s.finish_time||!s.stake_amount||!s.max_seats){n("Please fill in all required fields"),c(!1);return}try{if(s.start_time&&s.finish_time&&s.finish_time<=s.start_time){n("Finish time must be after start time"),c(!1);return}const o=await(await fetch("/api/operators/events/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:w,title:s.title,event_date:s.event_date,start_time:s.start_time,finish_time:s.finish_time,stake_amount:parseFloat(s.stake_amount),max_seats:parseInt(s.max_seats),host_name:s.host_name||null,host_logo_url:s.host_logo_url||null,host_location:s.host_location||null,host_location_lat:s.host_location_lat||null,host_location_lng:s.host_location_lng||null,host_description:s.host_description||null,sponsor_name:s.sponsor_name||null,sponsor_logo_url:s.sponsor_logo_url||null,sponsor_website:s.sponsor_website||null,sponsor_phone:s.sponsor_phone||null,sponsor_pot_value:s.sponsor_pot_value?O(s.sponsor_pot_value):0,sponsor_description:s.sponsor_description||null})})).json();if(o.ok)y(!0),setTimeout(()=>{m(`/operators/events/${o.event.id}`)},1500);else{const l=o.error||"Failed to create event",i=o.diag?` (Details: ${JSON.stringify(o.diag)})`:"";n(`${l}${i}`),console.error("[CREATE_EVENT] API error:",o)}}catch(t){console.error("[CREATE_EVENT] Network error:",t),n(`Network error: ${t.message||"Failed to create event. Please try again."}`)}finally{c(!1)}},a=r=>{const{name:t,value:o}=r.target;if(t==="sponsor_phone")p(l=>({...l,[t]:T(o)}));else if(t==="sponsor_pot_value")p(l=>({...l,[t]:$(o)}));else if(p(l=>({...l,[t]:o})),t==="host_description"){const l=o.trim().split(/\s+/).filter(i=>i.length>0).length;k(l)}else if(t==="sponsor_description"){const l=o.trim().split(/\s+/).filter(i=>i.length>0).length;S(l)}};return!h||!h.includes("chief_operator")&&!h.includes("super_admin")?e.jsxs("div",{className:"min-h-screen bg-[#fafafa]",children:[e.jsx(N,{active:"events",onNavigate:m}),e.jsx("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-7xl",children:e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:e.jsx("p",{className:"text-gray-600",children:"Only Chief Operators can create events."})})})]}):e.jsxs("div",{className:"min-h-screen bg-[#fafafa]",children:[e.jsx(N,{active:"events",onNavigate:m}),e.jsxs("div",{id:"main-content",className:"container mx-auto px-4 py-8 max-w-7xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("button",{onClick:()=>m("/operators/events"),className:"text-blue-600 hover:text-blue-700 mb-4",children:"â† Back to Events"}),e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:"Create Event"})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-8 shadow-sm max-w-4xl",children:[C&&e.jsx("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg text-green-800",children:"Event created successfully! Redirecting..."}),_&&e.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg text-red-800",children:_}),e.jsxs("form",{onSubmit:E,className:"space-y-8",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Event Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Title *"}),e.jsx("input",{type:"text",id:"title",name:"title",required:!0,value:s.title,onChange:a,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., February 2026 Operators Meeting"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"event_date",className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Date *"}),e.jsx("input",{type:"date",id:"event_date",name:"event_date",required:!0,value:s.event_date,onChange:a,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"start_time",className:"block text-sm font-medium text-gray-700 mb-2",children:"Start Time *"}),e.jsx("input",{type:"time",id:"start_time",name:"start_time",required:!0,value:s.start_time,onChange:a,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"finish_time",className:"block text-sm font-medium text-gray-700 mb-2",children:"Finish Time *"}),e.jsx("input",{type:"time",id:"finish_time",name:"finish_time",required:!0,value:s.finish_time,onChange:a,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"max_seats",className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Seats *"}),e.jsx("input",{type:"number",id:"max_seats",name:"max_seats",required:!0,min:"1",value:s.max_seats,onChange:a,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"20"})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"stake_amount",className:"block text-sm font-medium text-gray-700 mb-2",children:"Stake Amount ($) *"}),e.jsx("input",{type:"number",id:"stake_amount",name:"stake_amount",required:!0,min:"0",step:"0.01",value:s.stake_amount,onChange:a,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"50.00"})]})]})]}),e.jsxs("section",{className:"border-t pt-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Host Information"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"host_name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Host Name"}),e.jsx("input",{type:"text",id:"host_name",name:"host_name",value:s.host_name,onChange:a,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Acme Corporation"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Host Logo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/jpg",onChange:r=>{const t=r.target.files[0];t&&j("host",t)},className:"text-sm text-gray-600",disabled:u.host}),u.host&&e.jsx("span",{className:"text-sm text-gray-500",children:"Uploading..."}),s.host_logo_url&&e.jsx(v,{src:s.host_logo_url,alt:"Host logo",className:"h-12 w-auto",height:48})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"PNG or JPG, max 2MB. Recommended: 200x200px"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"host_location",className:"block text-sm font-medium text-gray-700 mb-2",children:"Host Location (Address)"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",id:"host_location",name:"host_location",value:s.host_location,onChange:a,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"123 Main St, City, State ZIP"}),s.host_location&&e.jsx("a",{href:F(),target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 whitespace-nowrap",children:"Get Directions"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Enter full address for map links"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"host_description",className:"block text-sm font-medium text-gray-700 mb-2",children:["Host Description",x>0&&e.jsxs("span",{className:`ml-2 text-sm ${x>150?"text-red-600":"text-gray-500"}`,children:["(",x,"/150 words)"]})]}),e.jsx("textarea",{id:"host_description",name:"host_description",rows:"4",value:s.host_description,onChange:a,maxLength:1e3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Brief description of the host (150 words max)"})]})]})]}),e.jsxs("section",{className:"border-t pt-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Sponsor Information (Optional)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sponsor_name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Sponsor Name"}),e.jsx("input",{type:"text",id:"sponsor_name",name:"sponsor_name",value:s.sponsor_name,onChange:a,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., TechCorp Inc"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sponsor Logo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"file",accept:"image/png,image/jpeg,image/jpg",onChange:r=>{const t=r.target.files[0];t&&j("sponsor",t)},className:"text-sm text-gray-600",disabled:u.sponsor}),u.sponsor&&e.jsx("span",{className:"text-sm text-gray-500",children:"Uploading..."}),s.sponsor_logo_url&&e.jsx(v,{src:s.sponsor_logo_url,alt:"Sponsor logo",className:"h-12 w-auto",height:48})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"PNG or JPG, max 2MB. Recommended: 200x200px"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sponsor_website",className:"block text-sm font-medium text-gray-700 mb-2",children:"Sponsor Website"}),e.jsx("input",{type:"url",id:"sponsor_website",name:"sponsor_website",value:s.sponsor_website,onChange:a,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sponsor_phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Sponsor Phone"}),e.jsx("input",{type:"tel",id:"sponsor_phone",name:"sponsor_phone",value:s.sponsor_phone,onChange:a,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"(555) 123-4567"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"sponsor_pot_value",className:"block text-sm font-medium text-gray-700 mb-2",children:"Sponsor Pot Value ($)"}),e.jsx("input",{type:"text",id:"sponsor_pot_value",name:"sponsor_pot_value",value:s.sponsor_pot_value,onChange:a,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Additional contribution to the pot for this event"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"sponsor_description",className:"block text-sm font-medium text-gray-700 mb-2",children:["Sponsor Description",g>0&&e.jsxs("span",{className:`ml-2 text-sm ${g>150?"text-red-600":"text-gray-500"}`,children:["(",g,"/150 words)"]})]}),e.jsx("textarea",{id:"sponsor_description",name:"sponsor_description",rows:"4",value:s.sponsor_description,onChange:a,maxLength:1e3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Brief description of the sponsor (150 words max)"})]})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4 border-t",children:[e.jsx("button",{type:"submit",disabled:b,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:b?e.jsxs(e.Fragment,{children:[e.jsx(L,{})," Creating..."]}):"Create Event"}),e.jsx("button",{type:"button",onClick:()=>m("/operators/events"),className:"min-h-[44px] px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Cancel"})]})]})]})]})]})}export{U as default};
//# sourceMappingURL=CreateEvent-BE7GPbSb.js.map
